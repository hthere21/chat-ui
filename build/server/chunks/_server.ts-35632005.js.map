{"version":3,"file":"_server.ts-35632005.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/settings/assistants/_assistantId_/avatar.jpg/_server.ts.js"],"sourcesContent":["import { c as collections } from \"../../../../../../chunks/database.js\";\nimport { e as error } from \"../../../../../../chunks/index.js\";\nimport { ObjectId } from \"mongodb\";\nconst GET = async ({ params }) => {\n  const assistant = await collections.assistants.findOne({\n    _id: new ObjectId(params.assistantId)\n  });\n  if (!assistant) {\n    throw error(404, \"No assistant found\");\n  }\n  if (!assistant.avatar) {\n    throw error(404, \"No avatar found\");\n  }\n  const fileId = collections.bucket.find({ filename: assistant._id.toString() });\n  const content = await fileId.next().then(async (file) => {\n    if (!file?._id) {\n      throw error(404, \"Avatar not found\");\n    }\n    const fileStream = collections.bucket.openDownloadStream(file?._id);\n    const fileBuffer = await new Promise((resolve, reject) => {\n      const chunks = [];\n      fileStream.on(\"data\", (chunk) => chunks.push(chunk));\n      fileStream.on(\"error\", reject);\n      fileStream.on(\"end\", () => resolve(Buffer.concat(chunks)));\n    });\n    return fileBuffer;\n  });\n  return new Response(content, {\n    headers: {\n      \"Content-Type\": \"image/jpeg\"\n    }\n  });\n};\nexport {\n  GET\n};\n"],"names":[],"mappings":";;;;;AAGK,MAAC,GAAG,GAAG,OAAO,EAAE,MAAM,EAAE,KAAK;AAClC,EAAE,MAAM,SAAS,GAAG,MAAM,WAAW,CAAC,UAAU,CAAC,OAAO,CAAC;AACzD,IAAI,GAAG,EAAE,IAAI,QAAQ,CAAC,MAAM,CAAC,WAAW,CAAC;AACzC,GAAG,CAAC,CAAC;AACL,EAAE,IAAI,CAAC,SAAS,EAAE;AAClB,IAAI,MAAM,KAAK,CAAC,GAAG,EAAE,oBAAoB,CAAC,CAAC;AAC3C,GAAG;AACH,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE;AACzB,IAAI,MAAM,KAAK,CAAC,GAAG,EAAE,iBAAiB,CAAC,CAAC;AACxC,GAAG;AACH,EAAE,MAAM,MAAM,GAAG,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAE,SAAS,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;AACjF,EAAE,MAAM,OAAO,GAAG,MAAM,MAAM,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,OAAO,IAAI,KAAK;AAC3D,IAAI,IAAI,CAAC,IAAI,EAAE,GAAG,EAAE;AACpB,MAAM,MAAM,KAAK,CAAC,GAAG,EAAE,kBAAkB,CAAC,CAAC;AAC3C,KAAK;AACL,IAAI,MAAM,UAAU,GAAG,WAAW,CAAC,MAAM,CAAC,kBAAkB,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;AACxE,IAAI,MAAM,UAAU,GAAG,MAAM,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,KAAK;AAC9D,MAAM,MAAM,MAAM,GAAG,EAAE,CAAC;AACxB,MAAM,UAAU,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC,KAAK,KAAK,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;AAC3D,MAAM,UAAU,CAAC,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;AACrC,MAAM,UAAU,CAAC,EAAE,CAAC,KAAK,EAAE,MAAM,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;AACjE,KAAK,CAAC,CAAC;AACP,IAAI,OAAO,UAAU,CAAC;AACtB,GAAG,CAAC,CAAC;AACL,EAAE,OAAO,IAAI,QAAQ,CAAC,OAAO,EAAE;AAC/B,IAAI,OAAO,EAAE;AACb,MAAM,cAAc,EAAE,YAAY;AAClC,KAAK;AACL,GAAG,CAAC,CAAC;AACL;;;;"}